---
# Example workflow for a Next.js project deployed to Vercel
# Copy this to your project's .github/workflows/ci.yaml

name: CI/CD Pipeline

on:
  push:
    branches: [main, dev]
  pull_request:
    branches: [main, dev]
  merge_group: {} # Validate merge queue entries

# Grant the minimum permissions the reusable workflow's jobs actually need.
# Adjust based on which pipeline stages you enable in .github/pipeline.yaml.
permissions:
  contents: write # release + sync jobs
  pull-requests: write # security, deploy, release, sync jobs
  deployments: write # deploy job
  packages: write # deploy job (GHCR)
  id-token: write # build (SLSA attestation) + deploy/release (OIDC)
  attestations: write # build job (SLSA build provenance)
  security-events: write # security scan SARIF upload

jobs:
  pipeline:
    uses: navigaite/github-organization/.github/workflows/universal-pipeline.yaml@v2
    with:
      config-file: .github/pipeline.yaml
    secrets:
      VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
      VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
      VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
      GH_TOKEN: ${{ secrets.GH_TOKEN }}
