---
# Pipeline configuration for Flutter project
# Save this as .github/pipeline.yaml in your project

version: '2.0'

stack: flutter

runtime:
  flutter_version: stable
  # Or specify a specific version:
  # flutter_version: "3.16.0"

pipeline:
  fail_fast: false
  enable_caching: true

security:
  enable: true
  trufflehog: true
  dependency_review: false # Not applicable for Flutter
  fail_on_secrets: true

lint:
  enable: true
  # Uses flutter analyze by default

test:
  enable: true
  # Uses flutter test by default
  coverage: true

build:
  enable: true
  # Uses flutter build web by default
  # Customize with:
  # command: flutter build apk --release
  upload_artifacts: true
  artifact_name: flutter-build
  artifact_path: build/web

deployment:
  provider: docker

  docker:
    image_name: my-flutter-app
    dockerfile: Dockerfile
    registry: ghcr
    platforms: linux/amd64,linux/arm64
    push: true

  environments:
    - name: production
      trigger:
        event: push
        branch: main
      auto_deploy: true

release:
  enable: false
